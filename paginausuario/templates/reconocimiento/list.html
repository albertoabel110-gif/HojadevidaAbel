{% extends 'az.html' %}
{% block title %}Reconocimientos{% endblock %}

{% block content %}

<style>
  .text-truncate-cell{
    max-width: 200px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
</style>

<div class="card shadow-sm border-0">
  <div class="card-header bg-white d-flex justify-content-between align-items-center">
    <div>
      <h3 class="mb-0">Reconocimientos</h3>
      <small class="text-muted">Listado de reconocimientos registrados</small>
    </div>

    {% if request.user.is_authenticated and request.user.is_staff %}
      <a href="{% url 'reconocimiento_create' %}" class="btn btn-dark btn-sm">‚ûï Nuevo Reconocimiento</a>
    {% endif %}
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-sm table-striped table-hover align-middle mb-0">
        <thead class="table-dark">
          <tr>
            {% if request.user.is_authenticated and request.user.is_staff %}
              <th class="text-nowrap">ID</th>
            {% endif %}
            <th class="text-nowrap">Tipo</th>
            <th class="text-nowrap">Fecha</th>
            <th class="text-nowrap">Descripci√≥n</th>
            <th class="text-nowrap">Entidad</th>
            <th class="text-nowrap">Contacto</th>
            <th class="text-nowrap">Tel√©fono</th>
            <th class="text-nowrap">Certificado</th>

            {% if request.user.is_authenticated and request.user.is_staff %}
              <th class="text-end text-nowrap">Acciones</th>
            {% endif %}
          </tr>
        </thead>

        <tbody>
          {% for r in reconocimientos %}
          <tr>

            {% if request.user.is_authenticated and request.user.is_staff %}
              <td class="text-muted">{{ r.idreconocimiento }}</td>
            {% endif %}

            <td class="text-nowrap">{{ r.tiporeconocimiento }}</td>

            <td class="text-nowrap">
              {{ r.fechareconocimiento|date:"d M, Y" }}
            </td>

            <td class="text-truncate-cell" title="{{ r.descripcionreconocimiento }}">
              {{ r.descripcionreconocimiento }}
            </td>

            <td class="text-truncate-cell" title="{{ r.entidadpatrocinadora }}">
              {{ r.entidadpatrocinadora }}
            </td>

            <td class="text-truncate-cell" title="{{ r.nombrecontactoauspicia }}">
              {{ r.nombrecontactoauspicia }}
            </td>

            <td class="text-nowrap">{{ r.telefonocontactoauspicia }}</td>

            <td class="text-nowrap">
              {% if r.rutacertificado %}
                <a class="btn btn-outline-secondary btn-sm" href="{{ r.rutacertificado.url }}" target="_blank">
                  Ver
                </a>
              {% else %}
                <span class="badge text-bg-light">Sin archivo</span>
              {% endif %}
            </td>

            {% if request.user.is_authenticated and request.user.is_staff %}
            <td class="text-end text-nowrap">
              <a href="{% url 'reconocimiento_update' r.pk %}" class="btn btn-warning btn-sm">‚úèÔ∏è</a>
              <a href="{% url 'reconocimiento_delete' r.pk %}" class="btn btn-danger btn-sm">üóëÔ∏è</a>
            </td>
            {% endif %}

          </tr>

          {% empty %}
          <tr>
            <td colspan="9" class="text-center text-muted py-4">
              No hay reconocimientos registrados
            </td>
          </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>
  </div>
</div>

{% endblock %}
